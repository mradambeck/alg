/*! algolia - v1.0.0 - 2016-07-21 */
console.log("sanity check: app.js");var setStars=function(a){return a<2e3?5:a<4e3?4:a<6e3?3:a<8e3?2:1},dedupe=function(a){return Array.from(new Set(a))},generateKeywords=function(a,b){for(var c=[],d=0;d<a.length;d++)switch(b){case"brand":c.push(a[d].brand);break;case"name":c.push(a[d].name);break;case"categories":for(var e=0;e<a[d].categories.length;e++)c.push(a[d].categories[e]);break;default:console.error("no typeToFilter provided in generateKeywords()")}var f=dedupe(c).sort(),g={keywords:f,keyType:b};return g};console.log("Sanity check: search.js");var app=angular.module("algolia-challenge",["algoliasearch"]);app.controller("SearchCtrl",["$scope","algolia",function(a,b){a.search={query:"",hits:[],brands:[],products:[],categories:[]};var c="LSTLHX1M78",d="2d33957a1e2b70a7d312983b2a1058d7",e=b.Client(c,d),f=e.initIndex("best_buy-demo_data"),g=e.initIndex("best_buy-brand"),h=e.initIndex("best_buy-name"),i=e.initIndex("best_buy-categories");a.$watch("search.query",function(){f.search(a.search.query).then(function(b){for(var c=b.hits,d=0;d<c.length;d++)c[d].stars=setStars(c[d].popularity);a.search.hits=c},function(a){console.error(a)});var b=function(b,c){a.search.brands=[],a.search.products=[],a.search.categories=[],c.search(a.search.query).then(function(c){for(var d=generateKeywords(c.hits,b);d.keywords.length>0;)switch(d.keyType){case"brand":a.search.brands.push(d.keywords.pop()),a.search.brands=dedupe(a.search.brands).sort().splice(0,5);break;case"name":a.search.products.push(d.keywords.pop()),a.search.products=dedupe(a.search.products).sort().splice(0,5);break;case"categories":a.search.categories.push(d.keywords.pop()),a.search.categories=dedupe(a.search.categories).sort().splice(0,5);break;default:console.error("Improper thisKeyHash")}},function(a){console.error(a)})};b("brand",g),b("name",h),b("categories",i)}),a.setQuery=function(b){a.search.query=b}}]);
//# sourceMappingURL=index.js.map